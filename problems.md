# Файл с известными проблемами

1. Ошибка при попытке зарегистрироваться с таким же username, который уже есть в системе

2. Отсутствует аватарка при поиске пользователя в модальном окне добавления участника доски

3. ~~Настройки пользователя слетают при переключениях~~ ✅ ПОЛНОСТЬЮ ИСПРАВЛЕНО И УЛУЧШЕНО
   - ✅ Исправлена проблема с несинхронностью данных между бэкендом и фронтендом
   - ✅ Добавлено автосохранение настроек интерфейса без кнопки "Сохранить"
   - ✅ Исправлен безопасный метод обновления настроек в репозитории
   - ✅ Добавлены индикаторы загрузки для каждой настройки отдельно
   - ✅ Реализован откат изменений при ошибках сохранения
   - ✅ Добавлены настройки языка (8 популярных языков с флагами)
   - ✅ Добавлены настройки часового пояса (IANA стандарт с 27 популярными зонами)
   - ✅ Реализована валидация языка и таймзоны на бэкенде для безопасности
   - ✅ Автоматическое определение языка и таймзоны пользователя по браузеру
   - ✅ Обновлены значения по умолчанию с UTC+3 на Europe/Moscow

4. ~~Не работают саб-таски~~ ✅ **ПОЛНОСТЬЮ ИСПРАВЛЕНО** (Обновлено: улучшен UX + проверена целостность БД)
   - ✅ Исправлена проблема закрытия модального окна при drag-and-drop операциях
   - ✅ Реализовано локальное состояние для подзадач без нарушения целостности данных
   - ✅ **НОВОЕ**: Убрана кнопка "Сохранить изменения" - теперь все автосохраняется
   - ✅ **НОВОЕ**: Реализовано автосохранение подзадач при переключении табов и закрытии модального окна
   - ✅ **НОВОЕ**: Модальное окно больше не закрывается при любых операциях с подзадачами
   - ✅ **НОВОЕ**: Локальные изменения подзадач сохраняются при переключении табов
   - ✅ Исправлена проблема с нарушением прав пользователя при переключении табов
   - ✅ Заменено опасное отображение HTML на безопасный TextRenderer в описании задач
   - ✅ **НОВОЕ**: Все операции с подзадачами теперь происходят без закрытия модального окна
   - ✅ **ПРОВЕРЕНО**: Каскадное удаление подзадач при удалении родительской задачи работает корректно
     * На уровне JPA: `@OneToMany(cascade = CascadeType.ALL, orphanRemoval = true)`
     * На уровне БД: `parent_task_id BIGINT REFERENCES tasks(id) ON DELETE CASCADE`

5. ~~Не работают аттачменты~~ ✅ ПОЛНОСТЬЮ ИСПРАВЛЕНО
   - ✅ Исправлено дублирование записей в истории при удалении файлов
   - ✅ Исправлено поведение скачивания (теперь принудительное сохранение через fetch + blob)
   - ✅ Добавлен предпросмотр текстовых файлов (.txt, .log) с загрузкой содержимого
   - ✅ Добавлен предпросмотр видео файлов с полным контролем воспроизведения
   - ✅ Убран предпросмотр PDF и DOCX файлов (остается только скачивание)
   - ✅ Исправлено удаление вложений из БД (добавлен orphanRemoval = true)
   - ✅ Добавлена поддержка drag-and-drop для загрузки файлов
   - ✅ Добавлены превью изображений в веб-версии списка вложений (как в мобильной)
   - ✅ Улучшен UI с адаптивным дизайном и темной темой

6. ~~Проблемы с уведомлениями~~ ✅ **ПОЛНОСТЬЮ ИСПРАВЛЕНО И УЛУЧШЕНО** (окончательно)
   - ✅ Добавлена полная система уведомлений с 17 типами
   - ✅ Исправлена кнопка "прочитано" - теперь корректно обновляет статус
   - ✅ Добавлен счетчик непрочитанных уведомлений в колокольчике
   - ✅ **ИСПРАВЛЕНО: WebSocket подключение восстановлено и работает корректно** (исправлен URL для WebSocket соединения, используется правильная переменная окружения VITE_APP_API_URL)
   - ✅ Добавлена возможность назначения ответственного на задачу
   - ✅ Уведомления отправляются только назначенным пользователям или администраторам
   - ✅ Добавлены автоматические уведомления о дедлайнах и просроченных задачах
   - ✅ Обработка упоминаний в комментариях (@username)
   - ✅ Исправлено дублирование информации в уведомлениях
   - ✅ Исправлено выравнивание иконок и чекбоксов в NotificationItem
   - ✅ Глобальный счетчик уведомлений отображается во всех частях приложения
   - ✅ **ИСПРАВЛЕНА ОШИБКА 403 при изменении настроек уведомлений**
   - ✅ **Все блоки настроек свернуты по умолчанию для компактности**
   - ✅ **Настройки работают независимо по каналам (веб, email, telegram)**
   - ✅ **Улучшен UI/UX с современным дизайном и подсказками**
   - ✅ **ДОБАВЛЕНА кнопка "Обновить" в странице уведомлений** для принудительной загрузки новых уведомлений
   - ✅ **ИСПРАВЛЕНО: Все типы уведомлений работают корректно** (taskAssigned работает независимо от taskUpdated)
   - ✅ **ИСПРАВЛЕНО: Telegram уведомления полностью интегрированы** (автоматически отправляются при создании уведомлений с проверкой настроек)

7. ~~Некорректный счетчик комментариев~~ ✅ **ИСПРАВЛЕНО**
   - ✅ Убрано дублирующее локальное состояние commentCount в TaskComments
   - ✅ Теперь используется единый источник данных: task.commentCount в табе и comments.length в заголовке
   - ✅ Счетчики синхронизируются через onTaskUpdate

8. Кривое модальное окно ответа на комментарий

9. В мобильной версии не перетаскиваются задачи

10. Не работает удаление доски
